---
title: "Simulation"
author: "Natalie"
date: "24 July 2015"
output: pdf_document
---

#Overview
In this paper we are investigating samples and their ability to estimate population paramaters such as mean. We are going to use the exponential distribution. The exponential distribution describes the probability distribution of the time between events in a Poisson process. For example we could use the exponential distribution to describe the time between people arriving at a bus stop. We are going to show that averages of samples from this distribution fall in a roughly normal distrubution centered at the population mean. We will show that averages most often fall near the true population mean and less often fall further away from the true population mean.

#Simulations
The exponential distribution follows the formula,  $f(x; \lambda) = \lambda \exp^{-\lambda x}$ for $x \ge 0$ where $\lambda$ is the rate of occurances per unit time. The mean of the exponential distribution, which is also the average time between events, has the formula $\mu = 1/\lambda$. We want to see that mean of random samples from this distribution fall in a mound shape around the population mean. We want to look at the distribution of sample means from the exponential distribution.

In our experiment $\lambda = 0.2$. A rate of 0.2 tell us that there are an average of .2 events in each period. The average time between events is $5$. Each sample in this experiment is 40 values randomly generated from the exponential distribution. Here are 40 samples using the R command for random expondentials ```rexp```
```{r}
lambda <- .2
sampleSize <- 40
set.seed(7)
sample <- rexp(sampleSize, rate = lambda)
```
Here are the first few values of our 40 sampled values:
```{r, echo=FALSE}
cat(head(sample, 3), sep = ", ")
```
The average of these 40 values is `r round(mean(sample), 2)`.


The sample mean of 4.97 is close to the distribution mean of 5 however we know if we took another 40 samples from the exponential distribution we would get a different mean. We are going to do exactly that. We are going to repeat this experement with 40 samples 1,000 times. Take the means from each of those samples of 40 and plot the resultant 1,000 means on a graph to see where they lie.

The following code takes 1,000 samples of 40 random values from the expondential. The average, or mean, of all these 1,000 samples is saved in a variable called $mns$.
```{r}
library(ggplot2)
mns = NULL  #initialise variable for means
vrs = NULL
for (i in 1 : 1000) {
    expdist <- rexp(sampleSize, rate = lambda)
    mns = c(mns, mean(expdist))
    vrs = c(vrs, var(expdist))
}
avgAllMeans <- mean(mns)
mns <- data.frame(mns)
sdMean <- 1/(sqrt(40) * lambda)
g <- ggplot(data = mns, aes(x = mns)) + geom_histogram(alpha = .20, binwidth = .2, colour = "black", aes(y = ..density..))
g <- g + stat_function(fun = dnorm, arg = list(mean = 1/lambda, sd = sdMean))
g <- g + geom_vline(xintercept = 1/lambda)
g <- g + geom_vline(xintercept = avgAllMeans)
g


hist(mns$mns)
abline(v = 1/lambda, lwd = 2)
hist(vrs)
abline(v = 1/lambda^2, lwd = 2)
hist(rexp(1000, lambda))
hist(sqrt(vrs))
abline(v = 1/lambda, lwd = 2)
```

In the code below we are taking 40 random samples from the exponential distribution.


###Heading 1
##Heading 2
#Heading 3

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r}
summary(cars)
```

You can also embed plots, for example:

```{r, echo=FALSE}
plot(cars)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
